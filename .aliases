alias dotfiles='/usr/bin/git --git-dir=$HOME/.dotfiles/ --work-tree=$HOME/'

alias vi='vim'
alias svi='sudo HOME=$(realpath ~esa) vim'
export EDITOR='vim'
alias vipaste='f=$(mktemp) && vi $f && fpaste $f && rm -f $f'

alias sshagent='eval $(ssh-agent) && ssh-add ~/.ssh/id_rsa'

alias gs='git status'
alias ga='git add'
alias gc='git commit'
alias gd='git diff'

alias r='exec zsh'

function sharefile {
    RHOST="nginx.tre.esav.fi"
    RPATH="/var/www/share"
    UUID=$(uuidgen)

    ssh $RHOST "mkdir $RPATH/$USER/$UUID"
    scp $1 $RHOST:$RPATH/$USER/$UUID/
    echo "https://share.esav.fi/$USER/$UUID/$1"
}

function imgurit {
    IMAGES_PATH="Pictures"
    file=$(ls -t $IMAGES_PATH/ | head -1)
    imgur-uploader "$IMAGES_PATH/$file"
}

function eyaml {
    if echo $PWD | grep -q "^/home/esav.fi/esa/workspace/puppet/control-repo"; then
        PUBKEY="/home/esav.fi/esa/workspace/puppet/control-repo/keys/public_key.pkcs7.pem"
    fi

    if echo $PWD | grep -q "^/home/esa/repos/puppet/ppadmin/"; then
        PUBKEY="/home/esa/repos/puppet/ppadmin/keys/public_key.pkcs7.pem"
    fi

    echo "Using pubkey $PUBKEY"

    if [[ "$1" == "edit" || "$1" == "encrypt" ]]; then
        oper=$1; shift
        ~/bin/eyaml $oper --pkcs7-public-key=$PUBKEY "$@"
    else
        ~/bin/eyaml "$@"
    fi
}